# Generated by Ansible
ClusterName={{ cluster_name }}
SlurmctldHost={{ slurm_control_host }}

SlurmUser=slurm
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmdPidFile=/var/run/slurmd.pid
SlurmctldLogFile={{ slurm_log_dir }}/slurmctld.log
SlurmdLogFile={{ slurm_log_dir }}/slurmd.log
StateSaveLocation={{ slurm_state_dir }}
ProctrackType=proctrack/cgroup
TaskPlugin=task/cgroup
ReturnToService=1
SlurmctldTimeout=120
SlurmdTimeout=300
InactiveLimit=0
KillWait=30
MinJobAge=300
SchedulerType=sched/backfill
SelectType=select/cons_tres
SelectTypeParameters=CR_Core

# Nodes from inventory
{% for host in groups['slurm_workers'] %}
NodeName={{ host }} CPUs={{ hostvars[host].ansible_facts['processor_vcpus'] | default(4) }} RealMemory={{ (hostvars[host].ansible_facts['memtotal_mb'] | default(8192)) | int }} State=UNKNOWN
{% endfor %}

PartitionName=invalid Nodes=NONE Default=NO MaxTime=INFINITE State=UP
{% for p in slurm_partitions %}
PartitionName={{ p.name }} Nodes={{ p.nodes }} Default={{ 'YES' if p.default else 'NO' }} MaxTime={{ p.maxtime }} State=UP
{% endfor %}

# Accounting (disabled by default)
AccountingStorageType=accounting_storage/none
JobCompType=jobcomp/none
